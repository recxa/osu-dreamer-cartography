<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Latent Space Cartography</title>
  <link rel="stylesheet" href="css/style.css">
  <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
  <div class="tooltip" id="tooltip"></div>

  <div class="page">
    <header class="header">
      <div class="header-eyebrow">experiment</div>
      <h1 class="header-title">latent space cartography</h1>
      <p class="header-sub">cross-mapper beatmap analysis · ismir 2026</p>
    </header>

    <div class="panels-row">
      <!-- Part A -->
      <section class="panel" id="part-a">
        <div class="panel-bar">
          <span class="panel-tag">part a</span>
          <span class="panel-name">interpretable dimensions</span>
        </div>
        <div class="panel-body">
          <p class="panel-desc">
            Cross-mapper agreement on 9-dim encoding.
            <strong>Timing</strong> (ONSET r=0.58) shows high agreement;
            <strong>spatial</strong> (X/Y r&asymp;0.008) shows near-zero.
          </p>
          <div id="chart-a" class="chart-area"></div>
          <div class="stats-row" id="stats-a"></div>
        </div>
      </section>

      <!-- Part B -->
      <section class="panel" id="part-b">
        <div class="panel-bar">
          <span class="panel-tag">part b</span>
          <span class="panel-name">latent dimensions</span>
        </div>
        <div class="panel-body">
          <p class="panel-desc">
            32-dim VAE latent space agreement.
            <strong>8/32 dims</strong> classified as perceptual (r&gt;0.3).
            Top dimension z<sub>21</sub> achieves r=0.451.
          </p>
          <div id="chart-b" class="chart-area"></div>
          <div class="stats-row" id="stats-b"></div>
        </div>
      </section>
    </div>

    <!-- Part C: Synthesis -->
    <section class="panel" id="part-c">
      <div class="panel-bar">
        <span class="panel-tag">part c</span>
        <span class="panel-name">synthesis &mdash; 32&times;9 correlation matrix</span>
      </div>
      <div class="panel-body">
        <p class="panel-desc">
          Correlation between 32 latent dims and 9 interpretable dims.
          Perceptual latent dims encode <strong>timing</strong> (ONSET+COMBO);
          lowest-ranked dims encode <strong>spatial</strong> (X).
        </p>
        <div class="heatmap-controls">
          <div class="ctrl">
            <label for="ordering">order</label>
            <select id="ordering">
              <option value="ranked">by agreement</option>
              <option value="sequential">sequential (0&ndash;31)</option>
            </select>
          </div>
          <div class="ctrl">
            <label for="threshold">threshold</label>
            <input type="range" id="threshold" min="0" max="0.5" step="0.01" value="0">
            <span class="threshold-val" id="threshold-value">|r| &gt; 0.00</span>
          </div>
          <div class="ctrl">
            <label><input type="checkbox" id="show-values"> values</label>
          </div>
        </div>
        <div class="heatmap-layout">
          <div id="heatmap-container" class="heatmap-scroll"></div>
          <div class="heatmap-sidebar">
            <div class="info-box">
              <div class="info-box-title">cell detail</div>
              <div id="cell-info">
                <p style="color:var(--text-muted);font-size:12px;">click a cell to inspect</p>
              </div>
            </div>
            <div class="info-box">
              <div class="info-box-title">matrix stats</div>
              <div class="stats-grid" id="matrix-stats"></div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Part D: Cross-Validation -->
    <section class="panel" id="part-d">
      <div class="panel-bar">
        <span class="panel-tag">part d</span>
        <span class="panel-name">cross-validation</span>
      </div>
      <div class="panel-body">
        <p class="panel-desc">
          VAE retrained on 579 mapsets (2-mapper songs), tested on held-out 271 mapsets.
          Cosine similarity <strong>holds</strong> on unseen data, confirming learned structure.
        </p>
        <div class="cv-layout">
          <div id="chart-d" class="comparison-bars"></div>
          <div id="cv-verdict"></div>
        </div>
        <div class="stats-row" id="stats-d"></div>
      </div>
    </section>

    <footer class="footer">
      <span>latent space cartography · ismir 2026</span>
      <span>·</span>
      <a href="https://github.com/recxa/osu-dreamer-cartography" target="_blank">github</a>
    </footer>
  </div>

  <script src="js/app.js"></script>
</body>
</html>
